分析：
判断连通性，很明显可以用并查集。

算法：
1. 按照时间排序，解决时间问题。
2. 按时间顺序枚举每条边，并连接这条边。
3. 题目要求的是“最后只剩下一个集合”，与普通并查集不同。可以维护变量tot记录连通块（集合）的数目，每次合并时减一，如果tot为1即代表结束。这样做到在O(1)的效率内统计个数。

总时间复杂度：
并查集 O(log n)
枚举 O(m)
维护集合数 O(1)
总复杂度 O(m log n)